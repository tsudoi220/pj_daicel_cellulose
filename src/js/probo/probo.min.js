/*

* Copyright (c) 2017 Business Search Technologies Corporation
* probo.js - probo javascript frontend module

*/
var ProboJs=function(){function x(u){return{opts:{inputid:{v:"q",vp:"^.+$"},areaid:{v:"probo",vp:"^.+$"},paramprefix:{v:"",vp:"^.*$"},thumburlprefix:{v:"thumbdir",vp:"^.*$"},anchortarget:{v:"_self",vp:"_self|_blank"},nearbypostfix:{v:"...",vp:"^.*$"},pagercount:{v:4,vp:"[0-9]+$"},resultcountlist:{v:"10,20,30",vp:"^[0-9,]+$"},usepdfnavi:{v:!1,vp:"true|false"},slideimagesize:{v:"l",vp:"^.+$"},nokeywordquery:{v:"",vp:"^.*$"},searchpostfix:{v:"",vp:"^.*$"},sortorder:{v:0,vp:"^[0-9]+$"},usekgtool:{v:!1,
vp:"true|false"},kgtoolcolumn:{v:31100,vp:"^[0-9]+$"},resultcount:{v:10,vp:"^[0-9]+$"},recommendcount:{v:3,vp:"^[0-9]+$"},relatedcount:{v:3,vp:"^[0-9]+$"},nearbysize:{v:50,vp:"^[0-9]+$"},searchmode:{v:"synonym",vp:"synonym|n-gram"},searchcolumn:{v:0,vp:"^[0-9]+$"},synonymcolumns:{v:"",vp:"^[0-9,]+$"},screenid:{v:"probo",vp:"^.+$"},resultgroup:{v:"text-1000",vp:"^.*$"},groupcolumn:{v:"25999",vp:"^[0-9]+$"},groupmax:{v:5,vp:"^[0-9]+$"},groupresultcount:{v:1E4,vp:"^[0-9]+$"},refinesubmit:{v:!0,vp:"true|false"},
noqueryparamprefix:{v:!0,vp:"true|false"},resourcegroup:{v:1,vp:"^[0-9]+$"},boxprefix:{v:"pbox-",vp:"^.*$"},callbackprefix:{v:"pjscb",vp:"^[a-zA-Z_]+$"}},pdfnaviLayoutOrder:"pdfnavititle pdfnavithumb nearby pdfnavithumbs listview slideview groupurl".split(" "),layoutOrder:["thumb","title","nearby","url"],paramCharset:"",queryError:!1,responseError:!1,apiResponse:null,pdfnaviApiResponse:null,isOldIE:!1,isIOS:!1,enableZoomThumb:!1,enableViewer:!1,params:{},pdfnaviParams:{},pdfnaviLastState:{},systemDefinedParams:{searchKeyword:{pn:"q",
dv:"",vp:"^.*$"},refine:{pn:"r",dv:"",vp:"^.*$"},resultPage:{pn:"p",dv:"1",vp:"^[0-9]+$"},resultCount:{pn:"c",dv:"10",vp:"^[0-9]+$"},sortOrder:{pn:"o",dv:"0",vp:"^[0-9]+$"}},userDefinedParams:{},systemDefinedPDFNaviParams:{url:{pn:"u",dv:"",vp:"^.*$"},mode:{pn:"m",dv:"",vp:"^.*$"},currentSlide:{pn:"s",dv:"1",vp:"^[0-9]+$"}},userDefinedPDFNaviParams:{},useBoxes:[],showedBoxes:0,onUpdate:{},userDefinedCallback:{},input:u,searchResultLayouts:{url:{resultField:{canChange:!1,userDefined:"",systemDefined:"url"},
recordType:"record",wrapElement:"div",action:function(a,c,b){var d=b.createElement(this.wrapElement,{className:"_url"}),e=b.getLayoutResultFields("url");a[e]&&(a=b.a2sv(a[e]),b=b.createElement("a",{href:a,className:"pbClick",target:b.getOpt("anchortarget")}),e=document.createTextNode(a),b.setAttribute("title",a),b.appendChild(e),d.appendChild(b));c.appendChild(d);return this}},title:{resultField:{canChange:!0,userDefined:"",systemDefined:"title"},recordType:"record",wrapElement:"div",action:function(a,
c,b){var d=b.createElement(this.wrapElement,{className:"_title"}),e=b.createElement("a",{href:a.url,className:"pbClick",target:b.getOpt("anchortarget")}),f=b.getLayoutResultFields("title"),k;a[f]?(k=document.createTextNode(b.a2sv(a[f])),e.setAttribute("title",b.a2sv(a[f]))):(k=document.createTextNode(b.getMess("searchresult no title")),e.setAttribute("title",b.getMess("searchresult no title")));e.appendChild(k);d.appendChild(e);c.appendChild(d);return this}},nearby:{resultField:{canChange:!1,userDefined:"",
systemDefined:"nearby"},recordType:"record",wrapElement:"div",action:function(a,c,b){var d=b.createElement(this.wrapElement,{className:"_nearby"}),e=b.getLayoutResultFields("nearby");if(a[e]){var f=b.getOpt("nearbypostfix");d.innerHTML=b.a2sv(a[e])+f}c.appendChild(d);return this}},filetype:{resultField:{canChange:!0,userDefined:"",systemDefined:"type"},recordType:"record",wrapElement:"span",action:function(a,c,b){var d,e=b.getLayoutResultFields("filetype");a[e]&&(a=b.a2sv(a[e]),d=b.createElement(this.wrapElement,
{className:"_type "+a}),b=document.createTextNode(b.getMess("type prefix")+a),d.appendChild(b));c.appendChild(d);return this}},size:{resultField:{canChange:!0,userDefined:"",systemDefined:"size"},recordType:"record",wrapElement:"span",action:function(a,c,b){var d=b.createElement(this.wrapElement,{className:"_size"}),e=b.getLayoutResultFields("size");a[e]&&(a=b.a2sv(a[e]),a=this.byte_convert(a),b=document.createTextNode(b.getMess("size prefix")+a),d.appendChild(b));c.appendChild(d);return this},byte_convert:function(a){a=
parseInt(a);for(var c=["Byte","KB","MB"],b=0;1024<a&&!(a/=1024,b++,b>c.length-1););return Math.round(a)+c[b]}},date:{resultField:{canChange:!0,userDefined:"",systemDefined:"date"},recordType:"record",wrapElement:"span",action:function(a,c,b){var d=b.createElement(this.wrapElement,{className:"_date"}),e=b.getLayoutResultFields("date");a[e]&&(a=b.a2sv(a[e]),a=this.date_convert(a),b=document.createTextNode(b.getMess("date prefix")+a),d.appendChild(b));c.appendChild(d);return this},date_convert:function(a){""!==
a&&(a=a.replace(/ .*$/,""));return a}},id:{resultField:{canChange:!0,userDefined:"",systemDefined:"resultid"},recordType:"record",wrapElement:"div",action:function(a,c,b){var d=b.createElement(this.wrapElement,{className:"_id"}),e,f="";!0===b.getOpt("usepdfnavi")?(e=b.getLayoutResultFields("groupid"),a[e]&&(f=b.a2sv(a[e]).split(/\./)[0])):(e=b.getLayoutResultFields("id"),a[e]&&(f=b.a2sv(a[e])));a=document.createTextNode(f);d.appendChild(a);c.appendChild(d);return this}},thumb:{resultField:{canChange:!0,
userDefined:"",systemDefined:"text-996"},recordType:"record",wrapElement:"div",action:function(a,c,b){var d=b.getOpt("thumburlprefix"),e=b.createElement(this.wrapElement,{className:"_thumb"}),f=b.getLayoutResultFields("thumb"),k=a.type;a[f]&&(a=f=b.a2sv(a[f]),f.match(/^https?:\/\//)||(f=d+"/"+f,""!==f&&(a=f.replace(/s\.jpg$/,"m.jpg"))),d=b.createElement("img",{src:f}),d.setAttribute("x-thumbtype",k),d.setAttribute("x-zoomurl",a),d.onmouseover=function(){var a=this.getAttribute("x-thumbtype"),e=this.getAttribute("x-zoomurl");
b.clearOverlay().showOverlay(e,a)},d.onmouseout=function(){b.hideOverlay().clearOverlay()},e.appendChild(d));c.appendChild(e);return this}},metaimg1:{resultField:{canChange:!0,userDefined:"",systemDefined:"text-899"},recordType:"record",wrapElement:"div",action:function(a,c,b){var d=b.createElement(this.wrapElement,{className:"_metaimg1"}),e=b.getLayoutResultFields("metaimg1");if(a[e])for(var f=0;f<a[e].length;f++){var k=b.createElement("img",{src:a[e][f]});d.appendChild(k)}c.appendChild(d);return this}},
metaimg2:{resultField:{canChange:!0,userDefined:"",systemDefined:"text-897"},recordType:"record",wrapElement:"div",action:function(a,c,b){var d=b.createElement(this.wrapElement,{className:"_metaimg2"}),e=b.getLayoutResultFields("metaimg2");if(a[e])for(var f=0;f<a[e].length;f++){var k=b.createElement("img",{src:a[e][f]});d.appendChild(k)}c.appendChild(d);return this}},metaimg3:{resultField:{canChange:!0,userDefined:"",systemDefined:"text-895"},recordType:"record",wrapElement:"div",action:function(a,
c,b){var d=b.createElement(this.wrapElement,{className:"_metaimg3"}),e=b.getLayoutResultFields("metaimg3");if(a[e])for(var f=0;f<a[e].length;f++){var k=b.createElement("img",{src:a[e][f]});d.appendChild(k)}c.appendChild(d);return this}},metaclass1:{resultField:{canChange:!0,userDefined:"",systemDefined:"text-898"},recordType:"record",wrapElement:"div",action:function(a,c,b){var d=b.createElement(this.wrapElement,{className:"_metaclass1"}),e=b.getLayoutResultFields("metaclass1");a[e]&&0<a[e].length&&
(a=a[e].join(" "),b=b.createElement("div",{className:a}),d.appendChild(b));c.appendChild(d);return this}},metaclass2:{resultField:{canChange:!0,userDefined:"",systemDefined:"text-896"},recordType:"record",wrapElement:"div",action:function(a,c,b){var d=b.createElement(this.wrapElement,{className:"_metaclass2"}),e=b.getLayoutResultFields("metaclass2");a[e]&&0<a[e].length&&(a=a[e].join(" "),b=b.createElement("div",{className:a}),d.appendChild(b));c.appendChild(d);return this}},metaclass3:{resultField:{canChange:!0,
userDefined:"",systemDefined:"text-894"},recordType:"record",wrapElement:"div",action:function(a,c,b){var d=b.createElement(this.wrapElement,{className:"_metaclass3"}),e=b.getLayoutResultFields("metaclass3");a[e]&&0<a[e].length&&(a=a[e].join(" "),b=b.createElement("div",{className:a}),d.appendChild(b));c.appendChild(d);return this}},anytext1:{resultField:{canChange:!0,userDefined:"",systemDefined:"text-891"},recordType:"record",wrapElement:"div",action:function(a,c,b){var d=b.createElement(this.wrapElement,
{className:"_anytext1"}),e=b.getLayoutResultFields("anytext1");a[e]&&(a=document.createTextNode(b.a2sv(a[e])),d.appendChild(a));c.appendChild(d);return this}},anytext2:{resultField:{canChange:!0,userDefined:"",systemDefined:"text-890"},recordType:"record",wrapElement:"div",action:function(a,c,b){var d=b.createElement(this.wrapElement,{className:"_anytext2"}),e=b.getLayoutResultFields("anytext2");a[e]&&(a=document.createTextNode(b.a2sv(a[e])),d.appendChild(a));c.appendChild(d);return this}},anytext3:{resultField:{canChange:!0,
userDefined:"",systemDefined:"text-889"},recordType:"record",wrapElement:"div",action:function(a,c,b){var d=b.createElement(this.wrapElement,{className:"_anytext3"}),e=b.getLayoutResultFields("anytext3");a[e]&&(a=document.createTextNode(b.a2sv(a[e])),d.appendChild(a));c.appendChild(d);return this}},anyhtml1:{resultField:{canChange:!0,userDefined:"",systemDefined:"text-888"},recordType:"record",wrapElement:"div",action:function(a,c,b){var d=b.createElement(this.wrapElement,{className:"_anyhtml1"}),
e=b.getLayoutResultFields("anyhtml1");a[e]&&(a=b.a2sv(a[e]),d.innerHTML=a);c.appendChild(d);return this}},anyhtml2:{resultField:{canChange:!0,userDefined:"",systemDefined:"text-887"},recordType:"record",wrapElement:"div",action:function(a,c,b){var d=b.createElement(this.wrapElement,{className:"_anyhtml2"}),e=b.getLayoutResultFields("anyhtml2");a[e]&&(a=b.a2sv(a[e]),d.innerHTML=a);c.appendChild(d);return this}},anyhtml3:{resultField:{canChange:!0,userDefined:"",systemDefined:"text-886"},recordType:"record",
wrapElement:"div",action:function(a,c,b){var d=b.createElement(this.wrapElement,{className:"_anyhtml3"}),e=b.getLayoutResultFields("anyhtml3");a[e]&&(a=b.a2sv(a[e]),d.innerHTML=a);c.appendChild(d);return this}},pdfnavititle:{resultField:{useLayouts:["title","currentpage","groupurl"],canChange:!1},wrapElement:"div",recordType:"record",action:function(a,c,b){var d=b.createElement(this.wrapElement,{className:"_pdftitle"}),e=b.createElement("a",{href:a.url,target:b.getOpt("anchortarget")}),f=b.getLayoutResultFields("title"),
k;a[f]?(k=document.createTextNode(b.a2sv(a[f])),e.setAttribute("title",b.a2sv(a[f]))):(k=document.createTextNode(b.getMess("searchresult no title")),e.setAttribute("title",b.getMess("searchresult no title")));var p=f="",g=b.getLayoutResultFields("currentpage"),h=b.getLayoutResultFields("groupurl");a[h]&&(f=b.a2sv(a[h]));a[g]&&(p=b.a2sv(a[g]));e.setAttribute("x-url",f);e.setAttribute("x-page",p);e.onclick=function(){var a=this.getAttribute("x-url"),e=this.getAttribute("x-page");b.launchViewer({url:a,
mode:"slide",currentSlide:e});return!1};e.appendChild(k);d.appendChild(e);c.appendChild(d);return this}},pdfnavithumb:{resultField:{useLayouts:["thumb","currentpage","groupurl"],canChange:!1},wrapElement:"div",recordType:"record",action:function(a,c,b){var d=b.getOpt("thumburlprefix"),e=b.createElement(this.wrapElement,{className:"_pdfthumb"}),f=b.getLayoutResultFields("thumb"),k=b.getLayoutResultFields("currentpage"),p=b.getLayoutResultFields("groupurl"),g="",h="",m="";a[p]&&(m=b.a2sv(a[p]));p=b.createElement("div",
{className:"_pdfpage"});a[k]&&(h=b.a2sv(a[k]),g=document.createTextNode(b.getMess("page")+h),p.appendChild(g));a[f]&&(g=b.a2sv(a[f]),a=g=d+"/"+g,a=g.replace(/s\.jpg$/,"m.jpg"),d=b.createElement("img",{src:g,className:"_pdfthumbimg"}),d.setAttribute("x-zoomurl",a),d.setAttribute("x-url",m),d.setAttribute("x-page",h),!0!==b.isIOS?(d.onmouseover=function(){var a=this.getAttribute("x-zoomurl");b.clearOverlay().showOverlay(a,"pdf")},d.onmouseout=function(){b.hideOverlay().clearOverlay()},d.onclick=function(){var a=
this.getAttribute("x-page"),a={url:this.getAttribute("x-url"),mode:"slide",currentSlide:a};b.hideOverlay().clearOverlay().launchViewer(a);return!1}):d.onclick=function(){var a=this.getAttribute("x-page"),a={url:this.getAttribute("x-url"),mode:"slide",currentSlide:a};b.launchViewer(a);return!1},e.appendChild(d),e.appendChild(p));c.appendChild(e);return this}},pdfnavithumbs:{resultField:{useLayouts:["thumb","currentpage","groupurl"],canChange:!1},wrapElement:"div",recordType:"group",action:function(a,
c,b){var d=b.getLayoutResultFields("thumb"),e=b.getLayoutResultFields("currentpage"),f=b.getLayoutResultFields("groupurl"),k=b.getOpt("thumburlprefix"),p=b.createElement(this.wrapElement,{className:"_pdfthumbs"}),g=b.createElement("ul",{className:"_thumbs"});if(!a.record)return this;for(var h=1;h<a.record.length;h++){var m=a.record[h],l="",n="",q="";m[f]&&(q=b.a2sv(m[f]));var r=b.createElement("div",{className:"_pdfpage"});m[e]&&(n=b.a2sv(m[e]),l=document.createTextNode(b.getMess("page")+n),r.appendChild(l));
m[d]&&(l=b.a2sv(m[d]),l=k+"/"+l,m=b.createElement("li",{className:"_pdfthumb"}),l=b.createElement("img",{src:l}),m.setAttribute("x-url",q),m.setAttribute("x-page",n),m.onclick=function(){var a=this.getAttribute("x-page"),a={url:this.getAttribute("x-url"),mode:"slide",currentSlide:a};b.launchViewer(a);return!1},m.appendChild(l),m.appendChild(r),g.appendChild(m))}p.appendChild(g);c.appendChild(p);return this}},listview:{resultField:{useLayouts:["groupurl"],canChange:!1},wrapElement:"div",action:function(a,
c,b){var d=b.createElement(this.wrapElement,{className:"_listview"}),e=b.getLayoutResultFields("groupurl"),f="";a[e]&&(f=b.a2sv(a[e]));a=b.createElement("a",{href:"#"});e=document.createTextNode(b.getMess("listview"));a.appendChild(e);a.setAttribute("x-url",f);a.onclick=function(){var a={url:this.getAttribute("x-url"),mode:"list",currentSlide:"1"};b.launchViewer(a);return!1};d.appendChild(a);c.appendChild(d);return this}},slideview:{resultField:{useLayouts:["groupurl"],canChange:!1},wrapElement:"div",
action:function(a,c,b){var d=b.createElement(this.wrapElement,{className:"_slideview"}),e=b.getLayoutResultFields("groupurl"),f="";a[e]&&(f=b.a2sv(a[e]));a=b.createElement("a",{href:"#"});e=document.createTextNode(b.getMess("slideview"));a.appendChild(e);a.setAttribute("x-url",f);a.onclick=function(){var a={url:this.getAttribute("x-url"),mode:"slide",currentSlide:"1"};b.launchViewer(a);return!1};d.appendChild(a);c.appendChild(d);return this}},groupurl:{resultField:{canChange:!0,userDefined:"",systemDefined:"text-1000"},
recordType:"record",wrapElement:"div",action:function(a,c,b){var d=b.createElement(this.wrapElement,{className:"_groupurl"}),e=b.getLayoutResultFields("groupurl");a[e]&&(a=b.a2sv(a[e]),b=b.createElement("a",{href:a,className:"pbClick",target:b.getOpt("anchortarget")}),e=document.createTextNode(a),b.setAttribute("title",a),b.appendChild(e),d.appendChild(b));c.appendChild(d);return this}},totalpages:{resultField:{canChange:!0,userDefined:"",systemDefined:"int-998"},wrapElement:"div",action:function(a,
c,b){var d=b.createElement(this.wrapElement,{className:"_totalpages"}),e=b.getLayoutResultFields("totalpages");a[e]&&(a=b.a2sv(a[e]),b=document.createTextNode(b.getMess("totalpage",{totalpage:a})),d.appendChild(b));c.appendChild(d);return this}},currentpage:{resultField:{canChange:!0,userDefined:"",systemDefined:"int-997"}},groupid:{resultField:{canChange:!1,userDefined:"",systemDefined:"groupid"}}},go:function(){var a=this.getOpt("areaid");""!==a&&document.getElementById(a)&&this.checkBrowser().detectCharset().defineAppParams().initParams().initElements().setDefaultParamsByOpts().setParamsByUrl().setSearchKeywordToInput().defineBoxes().initBoxes().initPDFNavi().update();
return this},setLayoutOrder:function(a){var c=a;"string"===typeof a&&(c=a.split(","));0===this.checkLayoutError(c)&&(this.layoutOrder=c);return this},setPDFNaviLayoutOrder:function(a){var c=a;"string"===typeof a&&(c=a.split(","));0===this.checkLayoutError(c)&&(this.pdfnaviLayoutOrder=c);return this},checkLayoutError:function(a,c){var b=this._getObjectName(a);"undefined"===typeof c&&(c=0);if("string"===b)this.searchResultLayouts[a]||c++;else{if("array"!==b)return 99;for(b=0;b<a.length;b++){var d=a[b];
"string"===this._getObjectName(d)?this.searchResultLayouts[d]||c++:c=this.checkLayoutError(d,c)}}return c},setLayoutResultFields:function(a){for(var c in a)if(""!==a[c]&&this.searchResultLayouts[c]){var b=this.searchResultLayouts[c].resultField;b&&!0===b.canChange&&(this.searchResultLayouts[c].resultField.userDefined=a[c])}return this},setLayoutWrapElements:function(a){for(var c in a)""!==a[c]&&(this.searchResultLayouts[c].wrapElement=a[c]);return this},setOptions:function(a){for(var c in a)this.setOpt(c,
a[c]);return this},setCallbacks:function(a){for(var c in a)"function"===typeof a[c]&&(this.userDefinedCallback[c]=a[c]);return this},setParamNames:function(a){for(var c in a)""!==a[c]&&this.systemDefinedParams[c]&&(this.userDefinedParams[c]={pn:a[c]})},callbackStartLoading:function(){this.userDefinedCallback.startLoading&&this.userDefinedCallback.startLoading();return this},callbackEndLoading:function(){this.userDefinedCallback.endLoading&&this.userDefinedCallback.endLoading();return this},callbackViewerStartLoading:function(){this.userDefinedCallback.viewerStartLoading&&
this.userDefinedCallback.viewerStartLoading();return this},callbackViewerEndLoading:function(){this.userDefinedCallback.viewerEndLoading&&this.userDefinedCallback.viewerEndLoading();return this},genResultFields:function(a){var c=[];if(a){for(var b=0;b<a.length;b++){var d=this.getLayoutResultFields(a[b]);-1===this._indexOf(c,d)&&c.push(d)}return c.join(",")}!0===this.getOpt("usepdfnavi")&&c.push(this.getLayoutResultFields("totalpages"));a=["layoutOrder","pdfnaviLayoutOrder"];for(b in a)for(var e=this[a[b]],
f=0;f<e.length;f++){var k=e[f];if(this.searchResultLayouts[k]&&(k=this.searchResultLayouts[k].resultField)){var p;if(k.useLayouts)for(d in k.useLayouts)p=this.getLayoutResultFields(k.useLayouts[d]),-1===this._indexOf(c,p)&&c.push(p);k.systemDefined&&(p=k.systemDefined,k.userDefined&&""!==k.userDefined&&(p=k.userDefined),-1===this._indexOf(c,p)&&c.push(p))}}return c.join(",")},checkBrowser:function(){var a=navigator.userAgent.toLowerCase();/msie *[6-9]./.test(a)?this.isOldIE=!0:/iphone|ipad/.test(a)&&
(this.isIOS=!0);return this},detectCharset:function(){for(var a=window.location.search.substring(1).split("&"),c=0;c<a.length;c++){var b=a[c].split("=");if(b[0]&&"charset"===b[0]&&b[1]&&""!==b[1]&&(b=decodeURIComponent(b[1]),this.validation(b,"^(Shift_JIS|SJIS|EUC-JP)$"))){this.paramCharset=b;break}}return this},defineAppParams:function(){var a=this.getOpt("paramprefix"),c=a;this.getOpt("noqueryparamprefix")&&(c="");for(var b=Object.keys(this.systemDefinedParams),d=0;d<b.length;d++){var e=b[d],f=
this.systemDefinedParams[e],k=f.pn;this.userDefinedParams[e]&&""!==this.userDefinedParams[e].pn&&(k=this.userDefinedParams[e].pn);var p=a+k;"searchKeyword"===e&&(p=c+k);f.pn=p;this.params[e]=f}return this},initParams:function(){var a=this.getOpt("areaid"),c=document.getElementById(a),b;for(b in this.params){var d=this.params[b].pn;if(this.params[b].id){var e=document.getElementById(this.params[b].id);e&&e.parentNode.removeChild(e)}e=a+Math.floor(1E4*Math.random())+"-"+d;d=this.createElement("input",
{type:"hidden",name:d,id:e,value:this.params[b].dv});c.appendChild(d);this.params[b].id=e}return this},initElements:function(){this.initOverlayElement();return this},initOverlayElement:function(){var a=this.getOpt("areaid")+"Overlay";if(document.getElementById(a))return this;a=this.createElement("div",{id:a});a.style.display="none";var c=this.getOpt("areaid");if(c=document.getElementById(c))c.appendChild(a),this.enableZoomThumb=!0;return this},initPDFNavi:function(){if(!0!==this.getOpt("usepdfnavi"))return this;
this.definePDFNaviParams().initPDFNaviElement().initPDFNaviParams();return this},definePDFNaviParams:function(){for(var a=Object.keys(this.systemDefinedPDFNaviParams),c=0;c<a.length;c++){var b=a[c],d=this.systemDefinedPDFNaviParams[b],e=d.pn;this.userDefinedPDFNaviParams[b]&&""!==this.userDefinedPDFNaviParams[b].pn&&(e=this.userDefinedPDFNaviParams[b].pn);d.pn=e;this.pdfnaviParams[b]=d}return this},initPDFNaviParams:function(){var a=this.getOpt("areaid")+"Viewer",c=document.getElementById(a),b;for(b in this.pdfnaviParams){var d=
this.pdfnaviParams[b].pn;if(this.pdfnaviParams[b].id){var e=document.getElementById(this.pdfnaviParams[b].id);e&&e.parentNode.removeChild(e)}e=a+Math.floor(1E4*Math.random())+"-"+d;d=this.createElement("input",{type:"hidden",name:d,id:e,value:this.pdfnaviParams[b].dv});c.appendChild(d);this.pdfnaviParams[b].id=e}return this},initPDFNaviElement:function(){if(!0!==this.getOpt("usepdfnavi"))return this;var a=this.getOpt("areaid")+"Viewer";if(document.getElementById(a))return this;var c=this.createElement("div",
{id:a});c.style.display="none";c.onclick=function(a){a.target===c&&(c.style.display="none")};var b=this.createElement("div",{className:"_wrapper"}),d=this.createElement("div",{id:a+"Header",className:"_head"}),e=this.createElement("span",{className:"_close"}),f=document.createTextNode(this.getMess("viewer close"));e.appendChild(f);e.onclick=function(){c.style.display="none"};d.appendChild(e);e=this.createElement("div",{id:a+"Info"});f=this.createElement("div",{id:a+"Tab"});a=this.createElement("div",
{id:a+"Cont"});b.appendChild(d);b.appendChild(e);b.appendChild(f);b.appendChild(a);c.appendChild(b);b=this.getOpt("areaid");if(b=document.getElementById(b))b.appendChild(c),this.enableViewer=!0;return this},launchViewer:function(a){if(!a||""===a.url)return this;var c=!1;this.getPDFNaviParam("url")!==a.url&&(c=!0);this.setPDFNaviParams(a).hideViewer().updateViewer(c).showViewer();return this},updateViewer:function(a){this.callbackViewerStartLoading();!0!==a?this.reloadViewer().callbackViewerEndLoading():
(a=this.getPDFNaviParam("url"),this.execSearchByURL(a));return this},reloadViewer:function(){var a=this.getOpt("areaid")+"Viewer";if(!document.getElementById(a))return this;var c=this.pdfnaviApiResponse;if(!c||c.error||c.totalhits&&1>c.totalhits||!c.searchresults||!c.searchresults.record||1>c.searchresults.record.length)return this;this.reloadPDFNaviTabArea(a+"Tab").reloadPDFNaviContentArea(a+"Cont");return this},reloadPDFNaviTabArea:function(a){var c=this,b=this.getPDFNaviLastState(),d=this.getPDFNaviParam("mode");
if(b.mode===d)return this;for(a=document.getElementById(a);a.firstChild;)a.removeChild(a.firstChild);for(var b=this.createElement("div",{className:"_tabs"}),e=["list","slide"],f=0;f<e.length;f++){var k=e[f],p=this.createElement("div",{className:"_tab _"+k});p.setAttribute("x-change",k);d===k?this._addClass(p,"_selected"):p.onclick=function(){var a=this.getAttribute("x-change");c.setPDFNaviParams({mode:a}).reloadViewer()};k=document.createTextNode(this.getMess("viewer "+k));p.appendChild(k);b.appendChild(p)}a.appendChild(b);
return this},reloadPDFNaviContentArea:function(a){var c=this,b=this.getPDFNaviLastState(),d=this.getPDFNaviParam("url"),e=this.getPDFNaviParam("mode"),f=this.getPDFNaviParam("currentSlide");if(b.url===d&&b.mode===e&&b.currentSlide===f)return this;for(a=document.getElementById(a);a.firstChild;)a.removeChild(a.firstChild);var k=this.getOpt("thumburlprefix"),p=this.getLayoutResultFields("thumb"),g=this.getLayoutResultFields("currentpage"),h=this.getLayoutResultFields("totalpages"),m=this.pdfnaviApiResponse,
l="",d=b="",n={};if("list"===e){f=this.getPDFNaviInfoArea();d=this.createElement("div",{className:"_pdflist"});for(e=0;e<m.searchresults.record.length;e++){var n=m.searchresults.record[e],h=this.createElement("div",{className:"_pdfrec"}),q=this.createElement("div",{className:"_pdfthumb"}),r=this.createElement("div",{className:"_pdfpage"});n[g]&&(b=this.a2sv(n[g]),l=document.createTextNode(this.getMess("page")+b),r.appendChild(l));n[p]&&(l=this.a2sv(n[p]),l=k+"/"+l,n=this.createElement("img",{src:l}),
""!==b&&(q.setAttribute("x-page",b),q.onclick=function(){var a=this.getAttribute("x-page");c.setPDFNaviParams({mode:"slide",currentSlide:a}).reloadViewer()}),q.appendChild(n));h.appendChild(q);h.appendChild(r);d.appendChild(h)}a.appendChild(f);a.appendChild(d)}else if("slide"===e){e=this.createElement("div",{className:"_pdfslide"});n=m.searchresults.record[f-1];if(!n)return this;m=this.createElement("div",{className:"_pdfthumb"});q=this.getOpt("slideimagesize");n[p]&&(l=this.a2sv(n[p]),l=l.replace(/s.jpg$/,
q+".jpg"),k=this.createElement("img",{src:k+"/"+l}),m.appendChild(k));k=this.createElement("div",{className:"_pdfpage"});n[g]&&n[h]&&(b=this.a2sv(n[g]),d=this.a2sv(n[h]),g=this.createElement("a",{className:"_pdfurl",href:n.url}),n=this.createElement("span",{className:"_pdfurlhint"}),p=document.createTextNode(this.getMess("viewer openpdf")),n.appendChild(p),p=document.createTextNode(this.getMess("page")),l=document.createTextNode(b),h=document.createTextNode("/"+d),g.appendChild(l),g.appendChild(n),
k.appendChild(p),k.appendChild(g),k.appendChild(h));g=this.createElement("div",{className:"_pdfprev"});n=document.createTextNode(this.getMess("viewer prev"));g.appendChild(n);"1"===f?this._addClass(g,"_noanc"):(n=parseInt(f)-1,g.setAttribute("x-page",n.toString()),g.onclick=function(){var a=this.getAttribute("x-page");c.setPDFNaviParams({currentSlide:a}).reloadViewer()});n=this.createElement("div",{className:"_pdfnext"});p=document.createTextNode(this.getMess("viewer next"));n.appendChild(p);b===
d?this._addClass(n,"_noanc"):(b=parseInt(f)+1,n.setAttribute("x-page",b.toString()),n.onclick=function(){var a=this.getAttribute("x-page");c.setPDFNaviParams({currentSlide:a}).reloadViewer()});e.appendChild(m);e.appendChild(g);e.appendChild(n);e.appendChild(k);a.appendChild(e)}return this},getPDFNaviInfoArea:function(){var a=this.getPDFNaviParam("url"),c=this.createElement("div",{className:"_pdfinfo"}),b=this.pdfnaviApiResponse.searchresults.record[0],d=this.getLayoutResultFields("title"),e=this.getMess("searchresult no title");
b[d]&&(e=this.a2sv(b[d]));b=this.createElement("div",{className:"_pdftitle"});e=document.createTextNode(this.getMess("viewer title prefix")+e);b.appendChild(e);e=this.createElement("div",{className:"_pdfurl"});d=document.createTextNode(this.getMess("viewer url prefix"));e.appendChild(d);d=this.createElement("a",{href:a,className:"pbClick",target:this.getOpt("anchortarget")});a=document.createTextNode(a);d.appendChild(a);e.appendChild(d);c.appendChild(b);c.appendChild(e);return c},hideViewer:function(){var a=
this.getOpt("areaid")+"Viewer";document.getElementById(a).style.display="none";return this},showViewer:function(){var a=this.getOpt("areaid")+"Viewer";document.getElementById(a).style.display="block";return this},execSearchByURL:function(a){if(""===a)return this;var c={},b=this.getOpt("resultgroup"),d=this.getOpt("groupcolumn"),e=this.getOpt("groupresultcount");c["show-results"]=!0;c["result-count"]=e;b=this.genResultFields(["title","thumb","totalpages","currentpage"])+","+b;c["result-fields"]=b;
c["sort-order"]=this.getLayoutResultFields("currentpage")+":a";c["nearby-size"]=0;c.search="_TEXT/EQ/"+d+"/"+a;var f=this.genCallbackName();c.callback=f;a=this.buildApiUrl(c);var k=this;window[f]=function(a){k.setPDFNaviApiResponse(a,f).reloadViewer().callbackViewerEndLoading()};a=this.createElement("script",{id:f,src:a,type:"text/javascript",charset:"utf-8"});document.getElementsByTagName("head")[0].appendChild(a);return this},setDefaultParamsByOpts:function(){var a=this.getOpt("sortorder");this.setParams({sortOrder:a});
a=this.getOpt("resultcount");this.setParams({resultCount:a});return this},setParamsByUrl:function(){var a=this.getUrlVars(),c=[],b;for(b in a)for(var d in this.params)if(this.params[d].pn===b)if("refine"===d)"string"===typeof a[b]?c.push(a[b]):c=a[b];else{var e=a[b];"string"!==typeof e&&(e=e[0]);""!==e&&(e=e.replace(/^[ \u3000]+/,"").replace(/[ \u3000]+$/,""));this.validation(e,this.params[d].vp)&&(document.getElementById(this.params[d].id).value=e)}0<c.length&&(a=c.join(","),this.validation(a,this.params.refine.vp)&&
(document.getElementById(this.params.refine.id).value=a));return this},setSearchKeywordToInput:function(){var a=this.getParam("searchKeyword"),c=this.getOpt("inputid");if(""!==c)for(var c=c.split(","),b=0;b<c.length;b++){var d=document.getElementById(c[b]);d&&(d.value=a)}return this},defineBoxes:function(){for(var a=this.defineBoxObjects(),c=this.getOpt("areaid"),b=document.getElementById(c).getElementsByTagName("*"),d=0;d<b.length;d++){var e=b[d].className;if(""!==e)for(var e=e.split(" "),f=0;f<
e.length;f++){var k=e[f];""!==k&&a[k]&&(this.useBoxes.push({name:k,id:c+Math.floor(1E4*Math.random())+"-"+k+"-"+(f+1),element:b[d],action:a[k]}),k=a[k].onUpdate,void 0!==k&&""!==k&&(this.onUpdate[k]=!0))}}return this},initBoxes:function(){for(var a=0;a<this.useBoxes.length;a++){var c=this.useBoxes[a];c.action.init(c,this)}return this},update:function(){this.callbackStartLoading();this.execSearch();return this},getLayoutResultFields:function(a){if(""!==a&&this.searchResultLayouts[a]){a=this.searchResultLayouts[a];
if(a.resultField){a=a.resultField;var c=a.userDefined;return!0===a.canChange&&""!==c?c:a.systemDefined}return""}},execSearch:function(){var a=this,c={};this.onUpdate["show-results"]&&(c["show-results"]=!0);if(!0===this.getOpt("usepdfnavi")){var b=this.getOpt("resultgroup"),d=this.getOpt("groupmax");c["result-group"]=b;c["group-max"]=d}b=this.getParam("sortOrder");b=this.getSortOrder(b);b.value&&(c["sort-order"]=b.value);b=this.getParam("resultCount");c["result-count"]=b;b=this.getParam("resultPage");
c["result-page"]=b;"synonym"===this.getOpt("searchmode")&&(c["search-mode"]="synonym");b=this.getOpt("synonymcolumns");""!==b&&(c["synonym-columns"]=b);(b=this.getOpt("nearbysize"))&&(c["nearby-size"]=b);(b=this.genResultFields())&&(c["result-fields"]=b);var b="",d=this.getParam("searchKeyword"),e=this.makeSearchQuery(d),b=b+e,e=this.getOpt("searchpostfix");""!==e&&(b=b+"( "+e+" )");e=this.refinementToQuery();""!==e&&(""===b&&(b="_ALL"),b=b+"  ("+e+")");var e=b,f=this.getOpt("nokeywordquery");if(""===
d&&""===f)return this.reloadBoxes(),this;""===b&&""!==f&&(e=f);if(this.queryError)return this.reloadBoxes(),this;if(""===e)this.reloadBoxes();else{c.search=e;c["log-keyword"]=d;var k=this.genCallbackName();c.callback=k;c=this.buildApiUrl(c);window[k]=function(b){a.setApiResponse(b,k).reloadBoxes()};c=this.createElement("script",{id:k,src:c,type:"text/javascript",charset:"utf-8"});document.getElementsByTagName("head")[0].appendChild(c)}return this},refinementToQuery:function(){for(var a=this.getParam("refine").split(","),
c=this.input.refine,b={},d=[],e=0;e<a.length;e++){var f=a[e].split(":");if(f[0]&&f[1]&&""!==f[0]&&""!==f[1]){var k=f[0],f=f[1];if(c[k]&&c[k].refines)for(var p=0;p<c[k].refines.length;p++){var g=c[k].refines[p];g.name===f&&(b[k]||(b[k]=[]),b[k].push("("+g.value+")"))}}}for(var h in b)a="("+b[h].join(" OR ")+")",d.push(a);return d.join(" AND ")},setPDFNaviApiResponse:function(a,c){this.pdfnaviApiResponse=this.parseApiResponse(a);window[c]=void 0;try{delete window[c]}catch(d){}if(document.getElementById(c)){var b=
document.getElementById(c);b.parentNode.removeChild(b)}return this},setApiResponse:function(a,c){this.apiResponse=this.parseApiResponse(a);window[c]=void 0;try{delete window[c]}catch(d){}if(document.getElementById(c)){var b=document.getElementById(c);b.parentNode.removeChild(b)}return this},parseApiResponse:function(a){var c="showurl urlbody morphemeresults recommendresults distributionresults categoriesresults categorypathresults categorytreeresults candidateresults hitsresults searchresults groupsearchresults".split(" "),
b=Object({});if(!a||1>a.length||!a.response)return b;a=this.a2sv(a.response);for(var d in a){var e=a[d];if("error"===d&&e)return this.responseError=!0,{};0<this._indexOf(c,d)&&(e=this.a2sv(e));b[d]=e}return b},getHref:function(a){var c=this.params,b=[],d={},e=this.getUrlVars(),f,k,p;for(p in c)f=c[p].pn,k="undefined"!==typeof a[p]?a[p]:this.getParam(p),d[f]=k;for(var g in e)"charset"!==g&&("undefined"!==typeof d[g]?(a=d[g],delete d[g]):a=e[g],a=g+"="+encodeURIComponent(a),b.push(a));for(var h in d)""!==
d[h]&&(e=h+"="+encodeURIComponent(d[h]),b.push(e));return"?"+b.join("&")},buildApiUrl:function(a){var c=this.apiurl,b=[],d;for(d in a){var e;switch(typeof a[d]){case "boolean":e=d;break;default:e=d+"="+encodeURIComponent(a[d].toString())}b.push(e)}a["show-results"]&&(b.push("result-info=all"),a=this.getOpt("searchcolumn"),""!==a&&b.push("search-column="+encodeURIComponent(a)));a=this.getOpt("screenid");b.push("custom-log="+encodeURIComponent("screen-id,"+a.toString()));b.push("result-format=jsonp");
return c+"?"+b.join("&")},genCallbackName:function(){for(var a=this.getOpt("callbackprefix");;){var c=a+Math.floor(1E11*Math.random());if(!window[c])return c}},reloadBoxes:function(){for(var a=0;a<this.useBoxes.length;a++){var c=this.useBoxes[a];c.action.go(c,this).show(c,this).showed(c,this)}return this},makeSearchQuery:function(a){a=this.splitBySeparator(a);return this.queryError?"":this.concatinateWords(a)},splitBySeparator:function(a){for(var c="",b="",d=[],e=!1,f=0;f<a.length;f++){var k=a.charAt(f);
"("!==k&&")"!==k&&"\u3000"!==k||!0===e||(k=" ");if('"'===k||"'"===k)if(""===c){e=!0;b=k;continue}else{if(e&&b===k){if(a.length>f+1&&" "!==a.charAt(f+1))return this.queryError=!0,[];e=!1;b="";continue}}else if(" "===k&&!e){""!==c&&(d.push(c),c="",e=!1,b="");continue}c+=k}if(e)return this.queryError=!0,[];""!==c&&d.push(c);return d},concatinateWords:function(a){for(var c=this.getOpt("searchcolumn"),b=this.getOpt("kgtoolcolumn"),d=[],e=0;e<a.length;e++){var f=this.canonicalWord(a[e]);if(""!==f){var k=
"_TEXT/EQ/"+c.toString()+"/"+f;!0===this.getOpt("usekgtool")?d.push("("+k+" OR "+("_TEXT/EQ/"+b.toString()+"/"+f)+")"):d.push(k)}}return d.join(" AND ")},canonicalWord:function(a){""!==a&&(a=a.replace(/^[ \u3000]+/,"").replace(/[ \u3000]+$/,""));return-1<this._indexOf(a,'"')?-1<this._indexOf(a,"'")?(this.queryError=!0,""):"'"+a+"'":'"'+a+'"'},clearOverlay:function(){if(!1===this.enableZoomThumb)return this;var a=this.getOpt("areaid")+"Overlay";if(a=document.getElementById(a))for(;1<=a.childNodes.length;)a.removeChild(a.firstChild);
return this},showOverlay:function(a,c){if(!1===this.enableZoomThumb)return this;var b=this.getOpt("areaid")+"Overlay",b=document.getElementById(b),d="container";""!==c&&(d=d+" "+c);if(b){var e=this.createElement("img",{src:a}),d=this.createElement("div",{className:d});d.appendChild(e);b.appendChild(d);b.style.display="block"}return this},hideOverlay:function(){if(!1===this.enableZoomThumb)return this;var a=this.getOpt("areaid")+"Overlay";if(a=document.getElementById(a))a.style.display="none";return this},
getSortOrder:function(a){var c=this.getOpt("resourcegroup");return this.input.sort&&this.input.sort[c]&&this.input.sort[c].sorts[a]?this.input.sort[c].sorts[a]:{}},getRefineValue:function(a,c){for(var b=this.getParam("refine").split(","),d=[],e=0;e<b.length;e++)(b[e]!==c||a)&&""!==b[e]&&d.push(b[e]);a&&d.push(c);return d.join(",")},setRefineParam:function(a,c){for(var b=this.getParam("refine").split(","),d=[],e=0;e<b.length;e++)(b[e]!==c||a)&&d.push(b[e]);a&&d.push(c);document.getElementById(this.params.refine.id).value=
d.join(",");return this},setOpt:function(a,c){a in this.opts&&this.validation(c,this.opts[a].vp)&&(this.opts[a].v=c);return this},getOpt:function(a){if(this.opts[a])return this.opts[a].v},setParams:function(a){for(var c in a)this.params[c]&&(document.getElementById(this.params[c].id).value=a[c]);return this},getParam:function(a){return this.params[a]&&this.params[a].id?document.getElementById(this.params[a].id).value:""},setPDFNaviLastState:function(){this.pdfnaviLastState={url:this.getPDFNaviParam("url"),
mode:this.getPDFNaviParam("mode"),currentSlide:this.getPDFNaviParam("currentSlide")};return this},getPDFNaviLastState:function(){return this.pdfnaviLastState},setPDFNaviParams:function(a){this.setPDFNaviLastState();for(var c in a)this.pdfnaviParams[c]&&(document.getElementById(this.pdfnaviParams[c].id).value=a[c]);return this},getPDFNaviParam:function(a){return this.pdfnaviParams[a]&&this.pdfnaviParams[a].id?document.getElementById(this.pdfnaviParams[a].id).value:""},getUrlVars:function(){var a={},
c,b=window.location.search.substring(1).split("&");for(c=0;c<b.length;c++){var d=b[c].split("=");if(d[0]){var e=this.convertEncoding(d[0]),d=this.convertEncoding(d[1]);""!==d&&(d=d.replace(/\+/g," "));if(a[e]){if("string"===typeof a[e]){var f=a[e];a[e]=[];a[e].push(f)}a[e].push(d)}else a[e]=d}}return a},getCountList:function(){for(var a=[],c=this.getOpt("resultcountlist").split(/ *, */),b=0;b<c.length;++b)""!==c[b]&&c[b].match(/^[0-9]+$/)&&a.push(c[b]);return a},convertEncoding:function(a){var c=
this.paramCharset;if("object"!==typeof Encoding||""===c)return decodeURIComponent(a);a=Encoding.urlDecode(a);"Shift_JIS"===c||"SJIS"===c?a=Encoding.convert(a,{to:"UNICODE",from:"SJIS"}):"EUC-JP"===c&&(a=Encoding.convert(a,{to:"UNICODE",from:"EUCJP"}));return a=Encoding.codeToString(a)},createElement:function(a,c){var b=document.createElement(a),d;for(d in c)b[d]=c[d];return b},validation:function(a,c){return""===c||a.toString().match(new RegExp(c))?!0:!1},hs:function(a){if(""!==a)return a.replace(/&/g,
"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},a2sv:function(a){return!0===this.isAry(a)&&0<a.length?a[0]:a},isAry:function(a){return"object"!==typeof a||"number"!==typeof a.length||"function"!==typeof a.splice||a.propertyIsEnumerable("length")?!1:!0},getMess:function(a,c){if(0>=arguments.length)return"";1>=arguments.length&&(c={});var b=this.getOpt("resourcegroup");if(this.input.message[b][a]){var b=this.input.message[b][a],d;for(d in c)b=b.replace("%"+d+"%",c[d]);return b}return""},
defineBoxObjects:function(){var a=this.getOpt("boxprefix"),c={};c[a+"search-status"]={go:function(a,b){var c,d={},g,h,m;c=b.getParam("searchKeyword");d.keyword='<span class="_kwd">'+b.hs(c)+"</span>";b.queryError?c="search status zero":!b.apiResponse||1>b.apiResponse.length?c="input search keyword":(g=0,b.apiResponse.grouphitsmax?g=b.apiResponse.grouphitsmax:b.apiResponse.totalhits&&(g=b.apiResponse.totalhits),d.totalhits='<span class="_totalhits">'+g+"</span>",d.countsuffix=b.getMess("count suffix"),
0<g?(h=parseInt(b.getParam("resultPage")),m=parseInt(b.getParam("resultCount")),h=(h-1)*m+1,m=parseInt(h)+m-1,g<m&&(m=g),d.countstart='<span class="_cstart">'+h+"</span>",d.countend='<span class="_cend">'+m+"</span>",c=""!==c?"search status":"search status no keyword hits"):c="search status zero");d=b.getMess(c,d);document.getElementById(a.id).innerHTML=d;a.isSuccess=!0;return this},onUpdate:"show-results"};c[a+"related"]={go:function(a,b){var c=this,d={},g=b.getParam("searchKeyword");if(""===g)return this;
d["get-adic"]=g;d["adic-type"]="related";var h=b.genCallbackName();d.callback=h;d=b.buildApiUrl(d);window[h]=function(d){c.callback(d,a,b).show(a).clean(h)};d=b.createElement("script",{id:h,src:d,type:"text/javascript",charset:"utf-8"});document.getElementsByTagName("head")[0].appendChild(d);return this},callback:function(a,b,c){a=c.parseApiResponse(a);if(!a||!a.related)return this;var d=a.related;if(0<d.length){var g=c.getOpt("relatedcount");a=[];var h=c.createElement("span",{className:"_title"}),
m=document.createTextNode(c.getMess("related box prefix"));h.appendChild(m);a.push(h);for(h=0;h<d.length;h++){var l=d[h];if(""!==l&&(m=document.createTextNode(l),l=c.getHref({searchKeyword:l,resultPage:1}),l=c.createElement("a",{className:"_kwd",href:l}),l.appendChild(m),a.push(l),h+1===g))break}for(c=0;c<a.length;c++)document.getElementById(b.id).appendChild(a[c]);b.isSuccess=!0}return this},clean:function(a){window[a]=void 0;try{delete window[a]}catch(b){}document.getElementById(a)&&(a=document.getElementById(a),
a.parentNode.removeChild(a));return this},onUpdate:""};c[a+"recommend"]={go:function(a,b){var c=this,d={},g=b.getParam("searchKeyword");if(""===g)return this;d["get-recommend"]=b.getOpt("recommendcount");d["recommend-search"]=c.canonicalRecommendKeyword(b,g);var h=b.genCallbackName();d.callback=h;d=b.buildApiUrl(d);window[h]=function(d){c.callback(d,a,b).show(a,b).clean(h)};d=b.createElement("script",{id:h,src:d,type:"text/javascript",charset:"utf-8"});document.getElementsByTagName("head")[0].appendChild(d);
return this},callback:function(a,b,c){var d=c.parseApiResponse(a);a=c.getOpt("areaid");if(!d||!d.recommendresults||!d.recommendresults.record)return this;d=d.recommendresults.record;if(0<d.length){var g=[],h=c.createElement("div",{className:"_caption"}),m=document.createTextNode(c.getMess("recommend box caption"));h.appendChild(m);g.push(h);h=c.createElement("div",{className:"_records"});for(m=0;m<d.length;m++){var l=d[m],n=l.fileid,q=c.createElement("div",{id:a+"Recommend"+l.resultid,className:"_record"}),
r=c.createElement("div",{className:"_image"});if(l.imageurl&&""!==l.imageurl){var t=c.createElement("img",{src:l.imageurl});r.appendChild(t)}q.appendChild(r);var w=this,r=c.createElement("div",{className:"_title"});if(l.title){t=c.createElement("a",{href:"#"});t.setAttribute("x-fileid",n);t.onclick=function(){w.locationRealUrl(this,c);return!1};var v=document.createTextNode(l.title);t.appendChild(v);r.appendChild(t)}q.appendChild(r);r=c.createElement("div",{className:"_summary"});l.summary&&""!==
l.summary&&(t=document.createTextNode(l.summary),r.appendChild(t));q.appendChild(r);r=c.createElement("div",{className:"_url"});l.displayurl&&""!==l.displayurl&&(t=c.createElement("a",{href:"#"}),t.setAttribute("x-fileid",n),t.onclick=function(){w.locationRealUrl(this,c);return!1},l=document.createTextNode(l.displayurl),t.appendChild(l),r.appendChild(t));q.appendChild(r);h.appendChild(q)}g.push(h);for(var u in g)document.getElementById(b.id).appendChild(g[u]);b.isSuccess=!0}return this},callbackRealUrl:function(a){if(!a.realurl)return this;
a=a.realurl;""!==a&&(location.href=a);return this},locationRealUrl:function(a,b){var c=this,d=a.getAttribute("x-fileid");if(!d)return!1;var g={};g["get-realurl"]=d;d=b.genCallbackName();g.callback=d;g=b.buildApiUrl(g);window[d]=function(a){c.callbackRealUrl(b.parseApiResponse(a),b)};g=b.createElement("script",{id:d,src:g,type:"text/javascript",charset:"utf-8"});document.getElementsByTagName("head")[0].appendChild(g);return this},canonicalRecommendKeyword:function(a,b){""!==b&&(b=b.replace(/^[ \u3000]+/,
"").replace(/[ \u3000]+$/,""),b=b.replace(/\s*\(\s*/g,"\uff08").replace(/\s*\)\s*/g,"\uff09"));return-1<a._indexOf(b,'"')?-1<a._indexOf(b,"'")?"":"'"+b+"'":'"'+b+'"'},clean:function(a){window[a]=void 0;try{delete window[a]}catch(b){}document.getElementById(a)&&(a=document.getElementById(a),a.parentNode.removeChild(a));return this},onUpdate:""};c[a+"searchresult"]={go:function(a,b){return!0===b.getOpt("usepdfnavi")?this.showGroupResults(a,b):this.showSearchResults(a,b)},showGroupResults:function(a,
b){var c=b.getOpt("areaid");if(!b.apiResponse||!b.apiResponse.groupsearchresults)return this;var d=b.apiResponse.groupsearchresults;if(!d.group||1>d.group.length)return this;for(var g=b.createElement("div",{className:"_records"}),h=0;h<d.group.length;h++){var m=d.group[h],l=parseInt(m.groupnumber),l=b.createElement("div",{id:c+"SearchResult"+l,className:"_record"});if(m.record&&!(1>m.record.length)){var n=m.record[0],q=b.getLayoutResultFields("totalpages");n[q]&&""!==n[q]?(b._addClass(l,"_pdfnavi"),
l=this.getPDFNaviLayouts(l,m,b)):l=this.getLayouts(l,m.record[0],b);g.appendChild(l)}}document.getElementById(a.id).appendChild(g);a.isSuccess=!0;return this},showSearchResults:function(a,b){var c=b.getOpt("areaid");if(!b.apiResponse||!b.apiResponse.searchresults)return this;var d=b.apiResponse.searchresults;if(!d.record||1>d.record.length)return this;for(var g=b.createElement("div",{className:"_records"}),h=0;h<d.record.length;h++){var m=d.record[h],l=parseInt(m.resultid),l=b.createElement("div",
{id:c+"SearchResult"+l,className:"_record"}),m=this.getLayouts(l,m,b);g.appendChild(m)}document.getElementById(a.id).appendChild(g);a.isSuccess=!0;return this},getLayouts:function(a,b,c){return this.buildLayouts(c.layoutOrder,a,b,null,c)},getPDFNaviLayouts:function(a,b,c){return this.buildLayouts(c.pdfnaviLayoutOrder,a,b.record[0],b,c)},buildLayouts:function(a,b,c,d,g,h){"undefined"===typeof h&&(h=1);for(var m=1,l=0;l<a.length;l++){var n=a[l],q=g._getObjectName(n);"array"===q?(q=g.createElement("div",
{className:"_layoutgroup"+(h.toString()+m.toString())}),q=this.buildLayouts(n,q,c,d,g,h+1),b.appendChild(q),m++):"string"===q&&((q=g.searchResultLayouts[n].recordType)&&"group"===q?g.searchResultLayouts[n].action(d,b,g):g.searchResultLayouts[n].action(c,b,g))}return b},onUpdate:"show-results"};c[a+"pagenav"]={go:function(a,b){if(!b.apiResponse||!b.apiResponse.searchresults&&!b.apiResponse.groupsearchresults)return this;var c=b.apiResponse.totalhits;!0===b.getOpt("usepdfnavi")&&(c=b.apiResponse.grouphitsmax);
var d=parseInt(b.getParam("resultPage")),g=b.getParam("resultCount"),g=Math.ceil(parseInt(c)/parseInt(g)),h=d-1,m=d+1;1>h&&(h=1);m>g&&(m=g);var c=b.createElement("div",{className:"_navs"}),l=b.createElement("span",{className:"_prev"}),n=document.createTextNode(b.getMess("previous page"));1===d?(l.appendChild(n),b._addClass(l,"_noanc")):(h=b.getHref({resultPage:h}),h=b.createElement("a",{href:h}),h.appendChild(n),l.appendChild(h));c.appendChild(l);for(l=0;l<g;l++){var q=parseInt(l+1),h=document.createTextNode(q.toString());
if(q===d)n=b.createElement("span",{className:"_page _cur"}),n.appendChild(h);else{var n=b.createElement("span",{className:"_page"}),r=b.getOpt("pagercount");if(q>d+r||q<d-r)n.style.display="none";q=b.getHref({resultPage:q});q=b.createElement("a",{href:q});q.appendChild(h);n.appendChild(q)}c.appendChild(n)}l=document.createTextNode(b.getMess("next page"));n=b.createElement("span",{className:"_next"});d===g?(n.appendChild(l),b._addClass(n,"_noanc")):(d=b.getHref({resultPage:m}),d=b.createElement("a",
{href:d}),d.appendChild(l),n.appendChild(d));c.appendChild(n);document.getElementById(a.id).appendChild(c);a.isSuccess=!0;return this},onUpdate:"show-results"};c[a+"count-selector"]={go:function(a,b){if(!b.apiResponse||!b.apiResponse.searchresults&&!b.apiResponse.groupsearchresults)return this;var c=parseInt(b.getParam("resultCount")),d=b.getCountList();if(1>d.length)return this;var g=b.createElement("dl",{className:"_counts"}),h=b.createElement("dt",{className:"_title"}),m=document.createTextNode(b.getMess("count select box caption"));
h.appendChild(m);g.appendChild(h);for(h=0;h<d.length;h++){var l=d[h],m=b.createElement("dd",{className:"_count"}),n=document.createTextNode(l+b.getMess("count suffix"));c===parseInt(l)?(b._addClass(m,"_selected"),m.appendChild(n)):(l=b.createElement("a",{href:b.getHref({resultCount:parseInt(l),resultPage:1})}),l.appendChild(n),m.appendChild(l));g.appendChild(m)}document.getElementById(a.id).appendChild(g);a.isSuccess=!0;return this},onUpdate:"show-results"};this.input.sort&&this.input.sort[this.getOpt("resourcegroup")]&&
(c[a+"sort-selector"]={go:function(a,b){if(!b.apiResponse||!b.apiResponse.searchresults&&!b.apiResponse.groupsearchresults)return this;var c=parseInt(b.getParam("sortOrder")),d=b.input.sort[b.getOpt("resourcegroup")].sorts;if(!d||1>d.length)return this;var g=b.createElement("dl",{className:"_sorts"}),h=b.createElement("dt",{className:"_title"}),m=document.createTextNode(b.getMess("sort select box caption"));h.appendChild(m);g.appendChild(h);for(h=0;h<d.length;h++){var l=d[h].label,m=b.createElement("dd",
{className:"_sort"}),l=document.createTextNode(l);if(c===h)b._addClass(m,"_selected"),m.appendChild(l);else{var n=b.createElement("a",{href:b.getHref({sortOrder:h,resultPage:1})});n.appendChild(l);m.appendChild(n)}g.appendChild(m)}document.getElementById(a.id).appendChild(g);a.isSuccess=!0;return this},onUpdate:"show-results"});if(this.input.refine)for(var b in this.input.refine)c[a+"refine-"+b]={init:function(a,b){var c=document.getElementById(a.id);c&&c.parentNode.removeChild(c);c=b.createElement("div",
{id:a.id,className:"_"+a.name});a.element.style.display="none";a.element.appendChild(c);this.ready(a,b).show(a,b);return this},go:function(){return this},ready:function(a,b){if(b.input.refine[this.rkey]){var c=b.getParam("refine").split(","),d=b.input.refine[this.rkey],g=document.createTextNode(d.caption),h=b.createElement("div",{className:"_title"});h.appendChild(g);for(var g=b.createElement("ul",{className:"_refs"}),d=d.refines,m=0;m<d.length;m++){for(var l=d[m],n=this.rkey+":"+l.name,q="_pbRef"+
this.rkey+"Cat"+m,r=b.createElement("li",{className:"_ref"}),t=b.createElement("label",{htmlFor:q}),q=b.createElement("input",{className:"check",id:q,type:"checkbox",name:"r",value:n}),u=!1,v=0;v<c.length;v++)if(c[v]===n){u=!0;q.setAttribute("checked","checked");break}q.onclick=function(){if(!1===b.getOpt("refinesubmit"))return!0;var a=b.getHref({resultPage:1,refine:b.getRefineValue(this.checked,this.value)});location.href=a};n=b.createElement("span",{className:"_text"});l=document.createTextNode(l.label);
n.appendChild(l);t.appendChild(q);t.appendChild(n);r.appendChild(t);g.appendChild(r);u&&q.setAttribute("checked","checked")}document.getElementById(a.id).appendChild(h);document.getElementById(a.id).appendChild(g)}else return this;a.isSuccess=!0;return this},rkey:b,onUpdate:"show-results"};for(var d in c)"function"!==typeof c[d].init&&(c[d].init=function(a,b){var c=document.getElementById(a.id);c&&c.parentNode.removeChild(c);c=b.createElement("div",{id:a.id,className:"_"+a.name});a.element.style.display=
"none";a.element.appendChild(c);return this}),"function"!==typeof c[d].show&&(c[d].show=function(a){!0===a.isSuccess&&(a.element.style.display="block");return this}),"function"!==typeof c[d].showed&&(c[d].showed=function(a,b){b.showedBoxes++;b.showedBoxes===b.useBoxes.length&&b.callbackEndLoading();return this}),c[d].name=d,c[d].isSuccess=!1;return c},_addClass:function(a,c){var b=a.className.split(" ");0>this._indexOf(b,c)&&(b.push(c),a.className=b.join(" "));return this},_removeClass:function(a,
c){var b=a.className.split(" "),d=this._indexOf(b,c);0<=d&&(b.splice(d,1),a.className=b.join(" "));return this},_hasClass:function(a,c){var b=(a.getAttribute("class")||elem.getAttribute("className")).split(" ");return-1!==this._indexOf(b,c)},_indexOf:function(a,c){if(Array.prototype.indexOf)return a.indexOf(c);for(var b in a)if(a[b]===c)return b;return-1},_getObjectName:function(a){return Object.prototype.toString.call(a).replace(/^\[object *(.*)\]$/,function(a,b){return b}).toLowerCase()}}}return{init:function(u){var a=
x(this.input);if("undefined"!==typeof u)return a.apiurl=u,a},noConflict:function(){return ProboJs},input:{layout:{},message:{},sort:{},refine:{}}}}();
